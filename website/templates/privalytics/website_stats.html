{% extends 'privalytics/base.html' %}
{% load static %}
{% block custom_css %}
    <link href="{% static 'privalytics/css/website_stats.css' %}" rel="stylesheet">

    <!-- Tempus Dominus Bootstrap 4 -->
    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/tempusdominus-bootstrap-4/5.1.2/css/tempusdominus-bootstrap-4.min.css"
          integrity="sha256-XPTBwC3SBoWHSmKasAk01c08M6sIA5gF5+sRxqak2Qs=" crossorigin="anonymous"/>

{% endblock %}

{% block content %}
   {% include 'privalytics/stats_navbar.html' %}
    <section id="website-stats">
        <div class="container">
            <div class="stats-summary">
                <div class="container-fluid">
                    <div class="row">
                        <div class="col-lg-3">
                            <div class="stats-summary-box">
                                <div class="stats-summary-title"><h2>Unique Visitors</h2></div>
                                <div class="stats-summary-body">{{ website.monthly_unique }}</div>
                                <div class="stats-small">In the last month</div>
                            </div>
                        </div>
                        <div class="col-lg-3">
                            <div class="stats-summary-box">
                                <div class="stats-summary-title"><h2>Page Views</h2></div>
                                <div class="stats-summary-body">{{ website.monthly_page_views }}</div>
                                <div class="stats-small">In the last month</div>
                            </div>
                        </div>
                        <div class="col-lg-3">
                            <div class="stats-summary-box">
                                <div class="stats-summary-title"><h2>Top Referrer</h2></div>
                                <div class="stats-summary-body">{{ website.top_referrer_week.referrer_url|truncatechars:20 }}</div>
                                <div class="stats-small">Visits: {{ website.top_referrer_week.visits }}</div>
                            </div>
                        </div>
                        <div class="col-lg-3">
                            <div class="stats-summary-box">
                                <div class="stats-summary-title"><h2>Top Page</h2></div>
                                <div class="stats-summary-body">
                                    <div class="toppage">{{ website.popular_pages_30_days.0.page|truncatechars:20 }}
                                        <span class="tooltiptext">{{ website.popular_pages_30_days.0.page }}</span>
                                    </div>
                                </div>
                                <div class="stats-small">Visits: {{ website.popular_pages_30_days.0.visits }}</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- Charts Start-->
        <div class="container">

            <div class="charts-area mg-b-15">
                <div class="container-fluid">
                    <div class="row">
                        <div class="col-lg-6">
                            <div class="stats-summary-box">
                                <div class="stats-summary-title">
                                    <h2>Visits Last 30 Days</h2>
                                </div>
                                <div id="bar1-chart">
                                    <canvas id="visitsdaychart"></canvas>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-6">
                            <div class="stats-summary-box">
                                <div class="stats-summary-title">
                                    <h2>Visits Last 48 hours</h2>
                                </div>
                                <div id="line2-chart">
                                    <canvas id="visitshourchart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-lg-6">
                            <div class="stats-summary-box">
                                <div class="stats-summary-title">
                                    <h2>Most Used Devices</h2>
                                </div>
                                <div id="bar3-chart">
                                    <canvas id="devices-chart"></canvas>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-6">
                            <div class="stats-summary-box">
                                <div class="stats-summary-title">
                                    <h2>Visitor Location Last 30 days</h2>
                                </div>
                                <p>&nbsp;</p>
                                <div id="world-map" style="width: 500px; height: 325px;">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-lg-6">
                        <div class="stats-summary-box">
                            <div class="stats-summary-title">
                                <h2>Popular Pages last 30 days</h2>
                            </div>
                            <table class="table">
                                <thead>
                                <tr>
                                    <td>Page</td>
                                    <td>Visits</td>
                                </tr>
                                </thead>
                                {% for page in website.popular_pages_30_days %}
                                    <tr>
                                        <td>{{ page.page }}</td>
                                        <td>{{ page.visits }}</td>
                                    </tr>
                                {% endfor %}
                            </table>
                        </div>
                    </div>
                    <div class="col-lg-6">
                        <div class="stats-summary-box">
                            <div class="stats-summary-title">
                                <h2>Top referrers last 30 days</h2>
                            </div>
                            <table class="table">
                                <thead>
                                <tr>
                                    <td>Referrer</td>
                                    <td>Visits</td>
                                </tr>
                                </thead>
                                {% for referrer in website.top_referrers_30_days %}
                                    <tr>
                                        <td>{{ referrer.referrer_url }}</td>
                                        <td>{{ referrer.visits }}</td>
                                    </tr>
                                {% endfor %}
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- Charts End-->
    </section>
{% endblock %}

{% block footer_scripts %}
    <script src="{% static 'accounts/js/jquery.sticky.js' %}"></script>
    <script src="{% static 'accounts/js/jquery.mCustomScrollbar.concat.min.js' %}"></script>
    <script src="{% static 'accounts/js/jquery.scrollUp.min.js' %}"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.3/Chart.bundle.min.js"></script>
    <script src="{% static 'accounts/js/main.js' %}"></script>
    <script src="{% static 'accounts/js/data-map/d3.min.js' %}"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3-tip/0.9.1/d3-tip.min.js"></script>
    <script src="{% static 'accounts/js/data-map/topojson.js' %}"></script>
    <script src="{% static 'accounts/js/data-map/datamaps.all.min.js' %}"></script>
    {% include 'privalytics/stats_scripts.html' %}

    <script src="{% static 'accounts/js/world_map.js' %}"></script>
{% endblock %}