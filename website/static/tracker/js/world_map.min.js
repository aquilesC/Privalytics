var dataset={};var onlyValues=countries.map(function(a){return a[1]});var minValue=Math.min.apply(null,onlyValues),maxValue=Math.max.apply(null,onlyValues);var paletteScale=d3.scale.linear().domain([minValue,maxValue]).range(["#EFEFFF","#02386F"]);countries.forEach(function(b){var a=b[0];var c=b[1];dataset[a]={requestsPerCountry:c,fillColor:paletteScale(c)}});new Datamap({element:document.getElementById("world-map"),projection:"mercator",height:500,fills:{defaultFill:"#F5F5F5"},data:dataset,geographyConfig:{borderColor:"#DEDEDE",highlightBorderWidth:2,highlightFillColor:function(a){return a.fillColor||"#F5F5F5"},highlightBorderColor:"#B7B7B7",popupTemplate:function(b,a){if(!a){return}return['<div class="hoverinfo">',"<strong>",b.properties.name,"</strong>","<br>Visits: <strong>",a.requestsPerCountry,"</strong>","</div>"].join("")}},options:{responsive:false}});